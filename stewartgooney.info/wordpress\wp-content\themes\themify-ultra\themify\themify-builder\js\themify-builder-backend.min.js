(function(a){if(0!==a("#page-builder.themify_write_panel").length){var b=themifybuilderapp,d=!1;b.mode=!1;b.render=function(){var e=a("body");e[0].insertAdjacentHTML("afterbegin",'<div class="themify_builder_fixed_scroll" id="themify_builder_fixed_bottom_scroll"></div>');e.addClass("builder-breakpoint-desktop").append(a("<div/>",{id:"themify_builder_alert"}));0===themifyBuilder.builder_data.length&&(themifyBuilder.builder_data={});this.toolbar=new b.Views.Toolbar({el:"#tb_toolbar"});b.Instances.Builder[0]=
new b.Views.Builder({el:"#themify_builder_row_wrapper",collection:new b.Collections.Rows(themifyBuilder.builder_data)});b.Instances.Builder[0].render();a("input#publish,input#save-post").one("click",function(f){d||(b.Utils.saveBuilder(function(){b.toolbar.undoManager.reset();a(f.currentTarget).trigger("click")}),f.preventDefault())});a('<a href="#" id="themify_builder_switch_frontend_button" class="button themify_builder_switch_frontend">'+themifyBuilder.i18n.switchToFrontendLabel+"</a>").on("click",
function(b){b.preventDefault();a("#themify_builder_switch_frontend").trigger("click")}).appendTo("#postdivrich #wp-content-media-buttons");a('input[name*="builder_switch_frontend"]').closest(".themify_field_row").remove();b.Views.bindEvents();b.Forms.bindEvents();b.vent.trigger("dom:builder:init",!0)};b._backendSwitchFrontend=function(){a("#builder_switch_frontend_noncename").val(1);d=!0;"publish"===a("#original_post_status").val()?a("#publish").trigger("click"):a("#save-post").trigger("click")};
b._backendBuilderFocus=function(){a("#page-buildert").trigger("click");a("html, body").animate({scrollTop:a("#tb_toolbar").offset().top-a("#wpadminbar").height()},2E3)};a(function(){b.render();if("function"===typeof window.icl_copy_from_original){var a=window.icl_copy_from_original;window.icl_copy_from_original=function(b,c){a(b,c);jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"themify_builder_icl_copy_from_original",source_page_id:c,source_page_lang:b},success:function(a){"-1"!=a&&jQuery("#page-builder .themify_builder.themify_builder_admin").empty().append(a).contents().unwrap()}})}}});
a(window).load(function(){function e(){c.width(c.width());k=d.offset().top;l=Math.round(a("#page-builder").offset().top);g.height(c.outerHeight(!0));a(window).scroll(function(){h&&clearTimeout(h);h=setTimeout(f,15)}).resize(function(){k=d.offset().top;c.width(a("#page-builder .themify_builder_admin").width()).css("top",m.outerHeight(!0));g.height(c.outerHeight(!0))})}function f(){h=null;var b=l+a("#page-builder").height(),d=a(this).scrollTop();d>k&&d<b?(c.addClass("tb_toolbar_fixed").css("top",n),
g.css("display","block")):(c.removeClass("tb_toolbar_fixed").css("top",0),g.css("display","none"))}var c=a("#tb_toolbar"),g=a("#themify_builder_module_tmp"),d=a("#tb_scroll_anchor"),k=0,h=null,l=0,m=a("#wpadminbar"),n=m.outerHeight(!0);if(0<c.length)if(c.is(":visible"))e();else a(".themify-meta-box-tabs a").one("click",function(){"page-buildert"===a(this).attr("id")&&e()});sessionStorage.getItem("focusBackendEditor")&&(b._backendBuilderFocus(),sessionStorage.removeItem("focusBackendEditor"))})}})(jQuery);
